
@{
    ViewData["Title"] = "MultiselectDropdown";
}

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<style>
    .selectBox select {
        width: 100%;
        cursor: pointer;
    }

    .overSelect {
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        cursor: pointer;
    }

    #mySelectOptions {
        display: none;
        border: 1px solid #7c7c7c;
        background-color: #ffffff;
        max-height: 150px;
        overflow-y: auto;
        position: absolute;
        width: 100%;
        z-index: 10;
    }

        #mySelectOptions label {
            display: block;
            font-weight: normal;
            white-space: nowrap;
            padding: 5px 10px;
            cursor: pointer;
        }

            #mySelectOptions label:hover {
                background-color: #1e90ff;
                color: #fff;
            }
</style>

<div class="container-fluid mt-3">
    <div class="form-group col-sm-8">
        <label for="myMultiselect">BS Custom Multiselect</label>
        <div id="myMultiselect" class="multiselect position-relative">
            <div id="mySelectLabel" class="selectBox" onclick="toggleCheckboxArea()">
                <select class="form-select">
                    <option id="selectedValues">Nothing is selected</option>
                </select>
                <div class="overSelect"></div>
            </div>
            <div id="mySelectOptions">
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="One" /> First checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Two" /> Second checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Three" /> Third checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Four" /> Fourth checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Five" /> Fifth checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Six" /> Sixth checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Seven" /> Seventh checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Eight" /> Eighth checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Nine" /> Ninth checkbox</label>
                <label><input type="checkbox" onchange="checkboxStatusChange()" value="Ten" /> Tenth checkbox</label>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        initMultiselect();
    });

    function initMultiselect() {
        checkboxStatusChange();

        document.addEventListener("click", function (evt) {
            var flyoutElement = document.getElementById("myMultiselect");
            var targetElement = evt.target;

            while (targetElement) {
                if (targetElement === flyoutElement) {
                    return; // Click inside, do nothing
                }
                targetElement = targetElement.parentNode;
            }

            // Click outside, hide the dropdown
            toggleCheckboxArea(true);
        });
    }

    function checkboxStatusChange() {
        var selectedValues = document.getElementById("selectedValues");
        var checkboxes = document.querySelectorAll("#mySelectOptions input[type=checkbox]:checked");

        let values = [];
        checkboxes.forEach((checkbox) => values.push(checkbox.value));

        selectedValues.textContent = values.length > 0 ? values.join(", ") : "Nothing is selected";
    }

    function toggleCheckboxArea(onlyHide = false) {
        var checkboxes = document.getElementById("mySelectOptions");
        if (onlyHide) {
            checkboxes.style.display = "none";
        } else {
            checkboxes.style.display = checkboxes.style.display === "block" ? "none" : "block";
        }
    }
</script>


